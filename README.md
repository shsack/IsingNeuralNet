# Learning Ising

We present two schemes to classify the two phases the 2D Ising model with an Artifical Neural Network.

![Ising](http://mathurl.com/y7ot2vl9.png)

Following [Machine Learning Phases of Matter](https://www.nature.com/articles/nphys4035) a Feed Forward Neural Network with a single hidden layer is trained to classify the two phases of the model. The spin configurations are generated by sampling from the Boltzmann distribution with a [Markov chain Monte Carlo](https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo) algorithm. 

Additionally, we present the confusion scheme presented in [Learning phases by confusion](https://www.nature.com/articles/nphys4037). The scheme combines supervised with unsupervised learning and allows to find the critical temperature without prior labeling of the data. 
 

## Running the programs

### Generate training data

To use the neural network, you first need to generate spin configurations of the 2D Ising model over a range of temperatures by running: 

```
python3 ising_lattice.py
```

This will generate the data and store it with an additional binary label that classifies the data into high and low temperature phases.
Additionally, a plot will be generated that shows the magnetization as a function of temperature, this allows to visualize the phase transition.

![magnetization_mc](https://user-images.githubusercontent.com/45107198/48675840-76f4ad80-eb5e-11e8-9520-19a3a14e4294.png)

### Training and testing the Neural Network

To train and test the neural network you need to run:

```
python3 neural_net_ising.py
```
 
This will first train the neural network on the spin configurations and secondly test the network on a different set of data.
The output of the network is plotted as a function of temperature. The output of the network is given by two neurons, one for classifying the high and one for the low temperature phase. The cross over of the two outputs indicates the critical temperature, that was learned form the training data.

![magnetization_nn](https://user-images.githubusercontent.com/45107198/48707754-b542a900-ec00-11e8-983e-52604775cfa5.png)

This shows that the neural network is able to learn the order parameter of the phase transition with very high accuracy.
Comparing the magnetization curve of the Monte Carlo simulation shows that the neural network is able to identify the magnetization as the relevant order parameter.

### Confusion scheme

To run the confusion scheme you need to run:

```
python3 confusion_NN.py
```

The scheme allows to identify the the critical temperature by confusing the neural network with wrong lablels. The network will be the least confused for the correct label. 

![confusion_nn](https://user-images.githubusercontent.com/45107198/48733990-661e6780-ec44-11e8-92f2-2923bba48401.png)

This replicates the critical temperature obtained by the Monte Carlo simulation.

## Authors

* **Stefan H Sack** 

